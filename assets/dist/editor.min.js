/*! For license information please see editor.min.js.LICENSE.txt */
(()=>{var e={744:function(e){e.exports=function(){"use strict";const{entries:e,setPrototypeOf:t,isFrozen:i,getPrototypeOf:a,getOwnPropertyDescriptor:n}=Object;let{freeze:o,seal:s,create:l}=Object,{apply:r,construct:c}="undefined"!=typeof Reflect&&Reflect;r||(r=function(e,t,i){return e.apply(t,i)}),o||(o=function(e){return e}),s||(s=function(e){return e}),c||(c=function(e,t){return new e(...t)});const d=_(Array.prototype.forEach),p=_(Array.prototype.pop),u=_(Array.prototype.push),m=_(String.prototype.toLowerCase),h=_(String.prototype.toString),g=_(String.prototype.match),f=_(String.prototype.replace),y=_(String.prototype.indexOf),v=_(String.prototype.trim),b=_(RegExp.prototype.test),w=(k=TypeError,function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return c(k,t)});var k;function _(e){return function(t){for(var i=arguments.length,a=new Array(i>1?i-1:0),n=1;n<i;n++)a[n-1]=arguments[n];return r(e,t,a)}}function x(e,a,n){n=n||m,t&&t(e,null);let o=a.length;for(;o--;){let t=a[o];if("string"==typeof t){const e=n(t);e!==t&&(i(a)||(a[o]=e),t=e)}e[t]=!0}return e}function C(t){const i=l(null);for(const[a,n]of e(t))i[a]=n;return i}function T(e,t){for(;null!==e;){const i=n(e,t);if(i){if(i.get)return _(i.get);if("function"==typeof i.value)return _(i.value)}e=a(e)}return function(e){return console.warn("fallback value for",e),null}}const A=o(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),E=o(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),S=o(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),N=o(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),R=o(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),I=o(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),M=o(["#text"]),D=o(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),P=o(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),O=o(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),L=o(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),F=s(/\{\{[\w\W]*|[\w\W]*\}\}/gm),$=s(/<%[\w\W]*|[\w\W]*%>/gm),j=s(/\${[\w\W]*}/gm),H=s(/^data-[\-\w.\u00B7-\uFFFF]/),B=s(/^aria-[\-\w]+$/),U=s(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),W=s(/^(?:\w+script|data):/i),z=s(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),G=s(/^html$/i);var J=Object.freeze({__proto__:null,MUSTACHE_EXPR:F,ERB_EXPR:$,TMPLIT_EXPR:j,DATA_ATTR:H,ARIA_ATTR:B,IS_ALLOWED_URI:U,IS_SCRIPT_OR_DATA:W,ATTR_WHITESPACE:z,DOCTYPE_NAME:G});const V=()=>"undefined"==typeof window?null:window;return function t(){let i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:V();const a=e=>t(e);if(a.version="3.0.2",a.removed=[],!i||!i.document||9!==i.document.nodeType)return a.isSupported=!1,a;const n=i.document;let{document:s}=i;const{DocumentFragment:l,HTMLTemplateElement:r,Node:c,Element:k,NodeFilter:_,NamedNodeMap:F=i.NamedNodeMap||i.MozNamedAttrMap,HTMLFormElement:$,DOMParser:j,trustedTypes:H}=i,B=k.prototype,W=T(B,"cloneNode"),z=T(B,"nextSibling"),K=T(B,"childNodes"),q=T(B,"parentNode");if("function"==typeof r){const e=s.createElement("template");e.content&&e.content.ownerDocument&&(s=e.content.ownerDocument)}const X=function(e,t){if("object"!=typeof e||"function"!=typeof e.createPolicy)return null;let i=null;const a="data-tt-policy-suffix";t.currentScript&&t.currentScript.hasAttribute(a)&&(i=t.currentScript.getAttribute(a));const n="dompurify"+(i?"#"+i:"");try{return e.createPolicy(n,{createHTML:e=>e,createScriptURL:e=>e})}catch(e){return console.warn("TrustedTypes policy "+n+" could not be created."),null}}(H,n),Y=X?X.createHTML(""):"",{implementation:Q,createNodeIterator:Z,createDocumentFragment:ee,getElementsByTagName:te}=s,{importNode:ie}=n;let ae={};a.isSupported="function"==typeof e&&"function"==typeof q&&Q&&void 0!==Q.createHTMLDocument;const{MUSTACHE_EXPR:ne,ERB_EXPR:oe,TMPLIT_EXPR:se,DATA_ATTR:le,ARIA_ATTR:re,IS_SCRIPT_OR_DATA:ce,ATTR_WHITESPACE:de}=J;let{IS_ALLOWED_URI:pe}=J,ue=null;const me=x({},[...A,...E,...S,...R,...M]);let he=null;const ge=x({},[...D,...P,...O,...L]);let fe=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),ye=null,ve=null,be=!0,we=!0,ke=!1,_e=!0,xe=!1,Ce=!1,Te=!1,Ae=!1,Ee=!1,Se=!1,Ne=!1,Re=!0,Ie=!1,Me=!0,De=!1,Pe={},Oe=null;const Le=x({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let Fe=null;const $e=x({},["audio","video","img","source","image","track"]);let je=null;const He=x({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Be="http://www.w3.org/1998/Math/MathML",Ue="http://www.w3.org/2000/svg",We="http://www.w3.org/1999/xhtml";let ze=We,Ge=!1,Je=null;const Ve=x({},[Be,Ue,We],h);let Ke;const qe=["application/xhtml+xml","text/html"];let Xe,Ye=null;const Qe=s.createElement("form"),Ze=function(e){return e instanceof RegExp||e instanceof Function},et=function(e){Ye&&Ye===e||(e&&"object"==typeof e||(e={}),e=C(e),Ke=Ke=-1===qe.indexOf(e.PARSER_MEDIA_TYPE)?"text/html":e.PARSER_MEDIA_TYPE,Xe="application/xhtml+xml"===Ke?h:m,ue="ALLOWED_TAGS"in e?x({},e.ALLOWED_TAGS,Xe):me,he="ALLOWED_ATTR"in e?x({},e.ALLOWED_ATTR,Xe):ge,Je="ALLOWED_NAMESPACES"in e?x({},e.ALLOWED_NAMESPACES,h):Ve,je="ADD_URI_SAFE_ATTR"in e?x(C(He),e.ADD_URI_SAFE_ATTR,Xe):He,Fe="ADD_DATA_URI_TAGS"in e?x(C($e),e.ADD_DATA_URI_TAGS,Xe):$e,Oe="FORBID_CONTENTS"in e?x({},e.FORBID_CONTENTS,Xe):Le,ye="FORBID_TAGS"in e?x({},e.FORBID_TAGS,Xe):{},ve="FORBID_ATTR"in e?x({},e.FORBID_ATTR,Xe):{},Pe="USE_PROFILES"in e&&e.USE_PROFILES,be=!1!==e.ALLOW_ARIA_ATTR,we=!1!==e.ALLOW_DATA_ATTR,ke=e.ALLOW_UNKNOWN_PROTOCOLS||!1,_e=!1!==e.ALLOW_SELF_CLOSE_IN_ATTR,xe=e.SAFE_FOR_TEMPLATES||!1,Ce=e.WHOLE_DOCUMENT||!1,Ee=e.RETURN_DOM||!1,Se=e.RETURN_DOM_FRAGMENT||!1,Ne=e.RETURN_TRUSTED_TYPE||!1,Ae=e.FORCE_BODY||!1,Re=!1!==e.SANITIZE_DOM,Ie=e.SANITIZE_NAMED_PROPS||!1,Me=!1!==e.KEEP_CONTENT,De=e.IN_PLACE||!1,pe=e.ALLOWED_URI_REGEXP||U,ze=e.NAMESPACE||We,fe=e.CUSTOM_ELEMENT_HANDLING||{},e.CUSTOM_ELEMENT_HANDLING&&Ze(e.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(fe.tagNameCheck=e.CUSTOM_ELEMENT_HANDLING.tagNameCheck),e.CUSTOM_ELEMENT_HANDLING&&Ze(e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(fe.attributeNameCheck=e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),e.CUSTOM_ELEMENT_HANDLING&&"boolean"==typeof e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements&&(fe.allowCustomizedBuiltInElements=e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),xe&&(we=!1),Se&&(Ee=!0),Pe&&(ue=x({},[...M]),he=[],!0===Pe.html&&(x(ue,A),x(he,D)),!0===Pe.svg&&(x(ue,E),x(he,P),x(he,L)),!0===Pe.svgFilters&&(x(ue,S),x(he,P),x(he,L)),!0===Pe.mathMl&&(x(ue,R),x(he,O),x(he,L))),e.ADD_TAGS&&(ue===me&&(ue=C(ue)),x(ue,e.ADD_TAGS,Xe)),e.ADD_ATTR&&(he===ge&&(he=C(he)),x(he,e.ADD_ATTR,Xe)),e.ADD_URI_SAFE_ATTR&&x(je,e.ADD_URI_SAFE_ATTR,Xe),e.FORBID_CONTENTS&&(Oe===Le&&(Oe=C(Oe)),x(Oe,e.FORBID_CONTENTS,Xe)),Me&&(ue["#text"]=!0),Ce&&x(ue,["html","head","body"]),ue.table&&(x(ue,["tbody"]),delete ye.tbody),o&&o(e),Ye=e)},tt=x({},["mi","mo","mn","ms","mtext"]),it=x({},["foreignobject","desc","title","annotation-xml"]),at=x({},["title","style","font","a","script"]),nt=x({},E);x(nt,S),x(nt,N);const ot=x({},R);x(ot,I);const st=function(e){u(a.removed,{element:e});try{e.parentNode.removeChild(e)}catch(t){e.remove()}},lt=function(e,t){try{u(a.removed,{attribute:t.getAttributeNode(e),from:t})}catch(e){u(a.removed,{attribute:null,from:t})}if(t.removeAttribute(e),"is"===e&&!he[e])if(Ee||Se)try{st(t)}catch(e){}else try{t.setAttribute(e,"")}catch(e){}},rt=function(e){let t,i;if(Ae)e="<remove></remove>"+e;else{const t=g(e,/^[\r\n\t ]+/);i=t&&t[0]}"application/xhtml+xml"===Ke&&ze===We&&(e='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+e+"</body></html>");const a=X?X.createHTML(e):e;if(ze===We)try{t=(new j).parseFromString(a,Ke)}catch(e){}if(!t||!t.documentElement){t=Q.createDocument(ze,"template",null);try{t.documentElement.innerHTML=Ge?Y:a}catch(e){}}const n=t.body||t.documentElement;return e&&i&&n.insertBefore(s.createTextNode(i),n.childNodes[0]||null),ze===We?te.call(t,Ce?"html":"body")[0]:Ce?t.documentElement:n},ct=function(e){return Z.call(e.ownerDocument||e,e,_.SHOW_ELEMENT|_.SHOW_COMMENT|_.SHOW_TEXT,null,!1)},dt=function(e){return"object"==typeof c?e instanceof c:e&&"object"==typeof e&&"number"==typeof e.nodeType&&"string"==typeof e.nodeName},pt=function(e,t,i){ae[e]&&d(ae[e],(e=>{e.call(a,t,i,Ye)}))},ut=function(e){let t;if(pt("beforeSanitizeElements",e,null),(i=e)instanceof $&&("string"!=typeof i.nodeName||"string"!=typeof i.textContent||"function"!=typeof i.removeChild||!(i.attributes instanceof F)||"function"!=typeof i.removeAttribute||"function"!=typeof i.setAttribute||"string"!=typeof i.namespaceURI||"function"!=typeof i.insertBefore||"function"!=typeof i.hasChildNodes))return st(e),!0;var i;const n=Xe(e.nodeName);if(pt("uponSanitizeElement",e,{tagName:n,allowedTags:ue}),e.hasChildNodes()&&!dt(e.firstElementChild)&&(!dt(e.content)||!dt(e.content.firstElementChild))&&b(/<[/\w]/g,e.innerHTML)&&b(/<[/\w]/g,e.textContent))return st(e),!0;if(!ue[n]||ye[n]){if(!ye[n]&&ht(n)){if(fe.tagNameCheck instanceof RegExp&&b(fe.tagNameCheck,n))return!1;if(fe.tagNameCheck instanceof Function&&fe.tagNameCheck(n))return!1}if(Me&&!Oe[n]){const t=q(e)||e.parentNode,i=K(e)||e.childNodes;if(i&&t)for(let a=i.length-1;a>=0;--a)t.insertBefore(W(i[a],!0),z(e))}return st(e),!0}return e instanceof k&&!function(e){let t=q(e);t&&t.tagName||(t={namespaceURI:ze,tagName:"template"});const i=m(e.tagName),a=m(t.tagName);return!!Je[e.namespaceURI]&&(e.namespaceURI===Ue?t.namespaceURI===We?"svg"===i:t.namespaceURI===Be?"svg"===i&&("annotation-xml"===a||tt[a]):Boolean(nt[i]):e.namespaceURI===Be?t.namespaceURI===We?"math"===i:t.namespaceURI===Ue?"math"===i&&it[a]:Boolean(ot[i]):e.namespaceURI===We?!(t.namespaceURI===Ue&&!it[a])&&!(t.namespaceURI===Be&&!tt[a])&&!ot[i]&&(at[i]||!nt[i]):!("application/xhtml+xml"!==Ke||!Je[e.namespaceURI]))}(e)?(st(e),!0):"noscript"!==n&&"noembed"!==n||!b(/<\/no(script|embed)/i,e.innerHTML)?(xe&&3===e.nodeType&&(t=e.textContent,t=f(t,ne," "),t=f(t,oe," "),t=f(t,se," "),e.textContent!==t&&(u(a.removed,{element:e.cloneNode()}),e.textContent=t)),pt("afterSanitizeElements",e,null),!1):(st(e),!0)},mt=function(e,t,i){if(Re&&("id"===t||"name"===t)&&(i in s||i in Qe))return!1;if(we&&!ve[t]&&b(le,t));else if(be&&b(re,t));else if(!he[t]||ve[t]){if(!(ht(e)&&(fe.tagNameCheck instanceof RegExp&&b(fe.tagNameCheck,e)||fe.tagNameCheck instanceof Function&&fe.tagNameCheck(e))&&(fe.attributeNameCheck instanceof RegExp&&b(fe.attributeNameCheck,t)||fe.attributeNameCheck instanceof Function&&fe.attributeNameCheck(t))||"is"===t&&fe.allowCustomizedBuiltInElements&&(fe.tagNameCheck instanceof RegExp&&b(fe.tagNameCheck,i)||fe.tagNameCheck instanceof Function&&fe.tagNameCheck(i))))return!1}else if(je[t]);else if(b(pe,f(i,de,"")));else if("src"!==t&&"xlink:href"!==t&&"href"!==t||"script"===e||0!==y(i,"data:")||!Fe[e])if(ke&&!b(ce,f(i,de,"")));else if(i)return!1;return!0},ht=function(e){return e.indexOf("-")>0},gt=function(e){let t,i,n,o;pt("beforeSanitizeAttributes",e,null);const{attributes:s}=e;if(!s)return;const l={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:he};for(o=s.length;o--;){t=s[o];const{name:r,namespaceURI:c}=t;if(i="value"===r?t.value:v(t.value),n=Xe(r),l.attrName=n,l.attrValue=i,l.keepAttr=!0,l.forceKeepAttr=void 0,pt("uponSanitizeAttribute",e,l),i=l.attrValue,l.forceKeepAttr)continue;if(lt(r,e),!l.keepAttr)continue;if(!_e&&b(/\/>/i,i)){lt(r,e);continue}xe&&(i=f(i,ne," "),i=f(i,oe," "),i=f(i,se," "));const d=Xe(e.nodeName);if(mt(d,n,i)){if(!Ie||"id"!==n&&"name"!==n||(lt(r,e),i="user-content-"+i),X&&"object"==typeof H&&"function"==typeof H.getAttributeType)if(c);else switch(H.getAttributeType(d,n)){case"TrustedHTML":i=X.createHTML(i);break;case"TrustedScriptURL":i=X.createScriptURL(i)}try{c?e.setAttributeNS(c,r,i):e.setAttribute(r,i),p(a.removed)}catch(e){}}}pt("afterSanitizeAttributes",e,null)},ft=function e(t){let i;const a=ct(t);for(pt("beforeSanitizeShadowDOM",t,null);i=a.nextNode();)pt("uponSanitizeShadowNode",i,null),ut(i)||(i.content instanceof l&&e(i.content),gt(i));pt("afterSanitizeShadowDOM",t,null)};return a.sanitize=function(e){let t,i,o,s,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(Ge=!e,Ge&&(e="\x3c!--\x3e"),"string"!=typeof e&&!dt(e)){if("function"!=typeof e.toString)throw w("toString is not a function");if("string"!=typeof(e=e.toString()))throw w("dirty is not a string, aborting")}if(!a.isSupported)return e;if(Te||et(r),a.removed=[],"string"==typeof e&&(De=!1),De){if(e.nodeName){const t=Xe(e.nodeName);if(!ue[t]||ye[t])throw w("root node is forbidden and cannot be sanitized in-place")}}else if(e instanceof c)t=rt("\x3c!----\x3e"),i=t.ownerDocument.importNode(e,!0),1===i.nodeType&&"BODY"===i.nodeName||"HTML"===i.nodeName?t=i:t.appendChild(i);else{if(!Ee&&!xe&&!Ce&&-1===e.indexOf("<"))return X&&Ne?X.createHTML(e):e;if(t=rt(e),!t)return Ee?null:Ne?Y:""}t&&Ae&&st(t.firstChild);const d=ct(De?e:t);for(;o=d.nextNode();)ut(o)||(o.content instanceof l&&ft(o.content),gt(o));if(De)return e;if(Ee){if(Se)for(s=ee.call(t.ownerDocument);t.firstChild;)s.appendChild(t.firstChild);else s=t;return(he.shadowroot||he.shadowrootmod)&&(s=ie.call(n,s,!0)),s}let p=Ce?t.outerHTML:t.innerHTML;return Ce&&ue["!doctype"]&&t.ownerDocument&&t.ownerDocument.doctype&&t.ownerDocument.doctype.name&&b(G,t.ownerDocument.doctype.name)&&(p="<!DOCTYPE "+t.ownerDocument.doctype.name+">\n"+p),xe&&(p=f(p,ne," "),p=f(p,oe," "),p=f(p,se," ")),X&&Ne?X.createHTML(p):p},a.setConfig=function(e){et(e),Te=!0},a.clearConfig=function(){Ye=null,Te=!1},a.isValidAttribute=function(e,t,i){Ye||et({});const a=Xe(e),n=Xe(t);return mt(a,n,i)},a.addHook=function(e,t){"function"==typeof t&&(ae[e]=ae[e]||[],u(ae[e],t))},a.removeHook=function(e){if(ae[e])return p(ae[e])},a.removeHooks=function(e){ae[e]&&(ae[e]=[])},a.removeAllHooks=function(){ae={}},a}()}()}},t={};function i(a){var n=t[a];if(void 0!==n)return n.exports;var o=t[a]={exports:{}};return e[a].call(o.exports,o,o.exports,i),o.exports}(()=>{"use strict";const e={},t={};jQuery(document).ready((function(i){window.viIsEditing=!1;const n=wp.media({multiple:!0}),o=wp.media({multiple:!1}),s={galleryImage:(e,t)=>`<li class="vi-wpbulky-gallery-image" data-id="${t}"><i class="vi-wpbulky-remove-image dashicons dashicons-no-alt"> </i><img src="${e}"></li>`,fileDownload(e={}){let{id:t,name:a,file:n}=e,o=i(`<tr>\n                        <td><i class="bars icon"></i><input type="text" class="vi-wpbulky-file-name" value="${a||""}"></td>\n                        <td>\n                            <input type="text" class="vi-wpbulky-file-url" value="${n||""}">\n                            <input type="hidden" class="vi-wpbulky-file-hash" value="${t||""}">\n                            <span class="vi-ui button mini vi-wpbulky-choose-file">${l.text("Choose file")}</span>\n                            <i class="vi-wpbulky-remove-file dashicons dashicons-no-alt"> </i>\n                        </td>\n                    </tr>`);return o.on("click",".vi-wpbulky-remove-file",(function(){o.remove()})),o}};e.textEditor={createCell:(e,t,i,a)=>(e.innerHTML=l.stripHtml(i).slice(0,50),e),closeEditor(e,t){window.viIsEditing=!1;let a="";return!0===t?(a=wp.editor.getContent("vi-wpbulky-text-editor"),this.isEditing||wp.editor.remove("vi-wpbulky-text-editor"),this.isEditing=!1):wp.editor.remove("vi-wpbulky-text-editor"),i("#vi-wpbulky-text-editor").val(""),a},openEditor(e,t,a){window.viIsEditing=!0;let n=e.getAttribute("data-y"),o=e.getAttribute("data-x"),s=a.options.data[n][o],l=this;i(".vi-ui.modal").modal("show"),this.tinymceInit(s),i(".vi-wpbulky-text-editor-save").off("click").on("click",(function(){i(this).removeClass("primary"),i(this).hasClass("vi-wpbulky-close")?i(".vi-ui.modal").modal("hide"):l.isEditing=!0,a.closeEditor(e,!0)})),i(".vi-ui.modal .close.icon").off("click").on("click",(function(){a.closeEditor(e,!0)})),i(".vi-ui.modal").parent().on("click",(function(t){t.target===t.delegateTarget&&a.closeEditor(e,!1)}))},updateCell(e,t,i){let a=wp.editor.getContent("vi-wpbulky-text-editor");return a.trim().length>0&&(t=a),e.innerHTML=l.stripHtml(t).slice(0,50),t},tinymceInit(e=""){e=wp.editor.autop(e),null===tinymce.get("vi-wpbulky-text-editor")&&(i("#vi-wpbulky-text-editor").val(e),a.tinyMceOptions.tinymce.setup=function(e){e.on("keyup",(function(e){i(".vi-wpbulky-text-editor-save:not(.vi-wpbulky-close)").addClass("primary")}))},wp.editor.initialize("vi-wpbulky-text-editor",a.tinyMceOptions)),tinymce.get("vi-wpbulky-text-editor").setContent(e)}},e.image={createCell(e,t,n,o){if(n){let t=a.imgStorage[n];l.isUrl(t)?i(e).html(`<img width="40" src="${t}" data-id="${n}">`):i(e).html("")}return e},closeEditor:(e,t)=>i(e).find("img").data("id")||"",openEditor(e,t,n){o.open().off("select").on("select",(function(t){let s=o.state().get("selection").first().toJSON();l.isUrl(s.url)&&(i(e).html(`<img width="40" src="${s.url}" data-id="${s.id}">`),a.imgStorage[s.id]=s.url,n.closeEditor(e,!0))}))},updateCell(e,t,n){t=parseInt(t)||"";let o=a.imgStorage[t];return l.isUrl(o)?i(e).html(`<img width="40" src="${o}" data-id="${t}">`):i(e).html(""),t}},e.imageurl={createCell:(e,t,a,n)=>(l.isUrl(a)?i(e).html(`<img width="40" src="${a}" >`):i(e).html(""),e),closeEditor:(e,t)=>i(e).find("img").attr("src")||"",openEditor(e,t,a){o.open().off("select").on("select",(function(t){let n=o.state().get("selection").first().toJSON();l.isUrl(n.url)&&(i(e).html(`<img width="40" src="${n.url}">`),a.closeEditor(e,!0))}))},updateCell:(e,t,a)=>(l.isUrl(t)?i(e).html(`<img width="40" src="${t}" >`):i(e).html(""),t)},e.gallery={saveData(e){let t=[];i(e).find(".vi-wpbulky-gallery-image").each((function(){t.push(i(this).data("id"))})),i(e).find(".vi-wpbulky-ids-list").val(t.join(","))},createCell(e,t,a){let n=a.length?"vi-wpbulky-gallery-has-item":"";return i(e).html(`<div class="vi-wpbulky-gallery ${n}"><i class="images outline icon"> </i></div>`),e},closeEditor(e,t){let a=[];return t&&(i(e).children().find(".vi-wpbulky-gallery-image").each((function(){a.push(i(this).data("id"))})),i(e).find(".vi-wpbulky-cell-popup").remove()),a},openEditor(e,t,o){let r=e.getAttribute("data-y"),c=e.getAttribute("data-x"),d=o.options.data[r][c],p=l.createEditor(e,"div"),u="";if(d.length)for(let e of d){let t=a.imgStorage[e];u+=s.galleryImage(t,e)}let m=i(`<div class="vi-wpbulky-cell-popup-inner">\n                                    <ul class="vi-wpbulky-gallery-images">${u}</ul>\n                                    <span class="vi-ui button tiny vi-wpbulky-add-image">${l.text("Add image")}</span>\n                                    <span class="vi-ui button tiny vi-wpbulky-remove-gallery">${l.text("Remove all")}</span>\n                                </div>`);i(p).append(m),m.find(".vi-wpbulky-gallery-images").sortable({items:"li.vi-wpbulky-gallery-image",cursor:"move",scrollSensitivity:40,forcePlaceholderSize:!0,forceHelperSize:!1,helper:"clone",placeholder:"vi-wpbulky-sortable-placeholder",tolerance:"pointer"}),m.on("click",".vi-wpbulky-remove-image",(function(){i(this).parent().remove()})),m.on("click",".vi-wpbulky-add-image",(function(){n.open().off("select close").on("select",(function(e){n.state().get("selection").each((function(e){"image"===(e=e.toJSON()).type&&(a.imgStorage[e.id]=e.url,m.find(".vi-wpbulky-gallery-images").append(s.galleryImage(e.url,e.id)))}))}))})),m.on("click",".vi-wpbulky-remove-gallery",(function(){m.find(".vi-wpbulky-gallery-images").empty()})),0===d.length&&m.find(".vi-wpbulky-add-image").trigger("click")},updateCell(e,t,a){let n=i(e).find(".vi-wpbulky-gallery");return t.length?n.addClass("vi-wpbulky-gallery-has-item"):n.removeClass("vi-wpbulky-gallery-has-item"),t}},e.download={createCell:(e,t,a)=>(i(e).html('<div><i class="download icon"> </i></div>'),e),closeEditor(e,t){let a=[];if(t){let t=i(e).children();t.find("table.vi-wpbulky-files-download tbody tr").each((function(){let e=i(this);a.push({id:e.find(".vi-wpbulky-file-hash").val(),file:e.find(".vi-wpbulky-file-url").val(),name:e.find(".vi-wpbulky-file-name").val()})})),t.remove()}return a},openEditor(e,t,a){let n,r=e.getAttribute("data-y"),c=e.getAttribute("data-x"),d=a.options.data[r][c],p=l.createEditor(e,"div"),u=i("<tbody></tbody>");if(Array.isArray(d))for(let e of d)u.append(s.fileDownload(e));let m=i(`<div class="">\n                                        <table class="vi-wpbulky-files-download vi-ui celled table">\n                                            <thead>\n                                            <tr>\n                                                <th>${l.text("Name")}</th>\n                                                <th>${l.text("File URL")}</th>\n                                            </tr>\n                                            </thead>\n                                        </table>\n                                        <span class="vi-ui button tiny vi-wpbulky-add-file">${l.text("Add file")}</span>\n                                    </div>`);m.find(".vi-wpbulky-files-download").append(u),i(p).append(m),u.sortable(),m.on("click",".vi-wpbulky-add-file",(()=>m.find(".vi-wpbulky-files-download tbody").append(s.fileDownload()))),m.on("click",".vi-wpbulky-choose-file",(function(){n=a.edition,a.edition=null;let e=i(this).closest("tr");o.open().off("select close").on("select",(function(t){let i=o.state().get("selection").first().toJSON();i.url&&e.find(".vi-wpbulky-file-url").val(i.url).trigger("change")})).on("close",(()=>a.edition=n))})),d.length||m.find(".vi-wpbulky-add-file").trigger("click")},updateCell:(e,t,a)=>(i(e).html('<div><i class="download icon"> </i></div>'),t)},e.link_posts={createCell:(e,t,i,a)=>(l.formatText(e,i),e),closeEditor(e,t){let a=i(e).children(),n=[];if(t){let e=a.find("select").select2("data");if(e.length)for(let t of e)n.push({id:t.id,text:t.text})}return a.remove(),i(".select2-container").remove(),n},openEditor(e,t,n){let o=e.getAttribute("data-y"),s=e.getAttribute("data-x"),r=n.options.data[o][s],c=l.createEditor(e,"div"),d=i("<select/>");i(c).append(d),d.select2({data:r,multiple:!0,minimumInputLength:3,placeholder:l.text("Search posts..."),ajax:{url:a.ajaxUrl,type:"post",delay:250,dataType:"json",data:function(e){return{...a.ajaxData,sub_action:"search_posts",search:e.term,type:"public"}},processResults:function(e){var t=[];return e&&i.each(e,(function(e,i){t.push({id:e,text:i})})),{results:t}}}}),d.find("option").attr("selected",!0).parent().trigger("change"),i(c).find(".select2-search__field").trigger("click")},updateCell:(e,t,i,a,n)=>(l.formatText(e,t),t)},e.array={createCell:(e,t,a,n)=>(i(e).html('<i class="icon edit"/>'),e),closeEditor(e,t){let i=[];return!0===t&&(i=this.editor.get()),l.removeModal(e),i},openEditor(e,t,a){let n=l.getDataFromCell(a,e),o=l.createModal({header:l.text("Edit metadata"),content:"",actions:[{class:"save-metadata",text:l.text("Save")}]});i(e).append(o),o.find(".content").html('<div id="vi-wpbulky-jsoneditor"></div>');let s=o.find("#vi-wpbulky-jsoneditor").get(0);this.editor=new JSONEditor(s,{enableSort:!1,search:!1,enableTransform:!1}),this.editor.set(n),o.on("click",(function(t){let n=i(t.target);(n.hasClass("close")||n.hasClass("vi-wpbulky-modal-container"))&&a.closeEditor(e,!1),n.hasClass("save-metadata")&&a.closeEditor(e,!0)}))},updateCell:(e,t,i)=>t},e.select2={type:"select2",createCell(e,t,i,a){let{source:n}=a.options.columns[t],o=[];return Array.isArray(i)||(i=Object.values(i)),Array.isArray(n)&&n.length&&(o=n.filter((e=>i.includes(e.id)))),l.formatText(e,o),e},openEditor(e,t,a){let n=e.getAttribute("data-y"),o=e.getAttribute("data-x"),s=a.options.data[n][o],r=i("<select/>"),{source:c,multiple:d,placeholder:p}=a.options.columns[o],u=l.createEditor(e,"div",r);r.select2({data:c||[],multiple:d,placeholder:p}),r.val(s).trigger("change"),i(u).find(".select2-search__field").trigger("click")},closeEditor(e,t){let a=i(e).children(),n=a.find("select").val();return n=n.map((e=>isNaN(e)?e:+e)),a.remove(),i(".select2-container").remove(),n},updateCell(e,t,i,a,n){let{source:o}=a.options.columns[n],s=[];return Array.isArray(o)&&o.length&&(s=o.filter((e=>t.includes(e.id)))),l.formatText(e,s),t}},e.ajax_search={type:"ajax_search",createCell:(e,t,i,a)=>(l.formatText(e,i),e),openEditor(e,t,n){let o=e.getAttribute("data-y"),s=e.getAttribute("data-x"),{taxonomy:r}=this.options,c=n.options.data[o][s],d=i("<select/>"),p=l.createEditor(e,"div",d);d.select2({data:c,multiple:!0,minimumInputLength:3,placeholder:l.text("Search ..."),ajax:{url:a.ajaxUrl,type:"POST",data:function(e){return{...a.ajaxData,sub_action:"ajax_search",taxonomy:r,search:e.term,post_type:a.postType}},processResults:function(e){return{results:e}}}}),d.find("option").attr("selected",!0).parent().trigger("change"),i(p).find(".select2-search__field").trigger("click")},closeEditor(e,t){let a=i(e).children(),n=a.find("select").select2("data"),o=[];if(n.length)for(let e of n)o.push({id:e.id,text:e.text});return a.remove(),i(".select2-container").remove(),o},updateCell:(e,t,i,a,n)=>(l.formatText(e,t),t)},t.sourceForVariation=(e,t,i,a,n)=>{let o=n.options.columns[i].source;return"variation"===l.getPostTypeFromCell(t)&&(o=n.options.columns[i].subSource),o}})),Array.prototype.insert=function(e,t){this.splice.apply(this,[e,0].concat(t))};const a={...wpbulkyParams,postTypes:{},filterKey:Date.now(),selectPage:1,ajaxData:{action:"vi_wpbulky_ajax",vi_wpbulky_nonce:wpbulkyParams.nonce},tinyMceOptions:{tinymce:{theme:"modern",skin:"lightgray",language:"en",formats:{alignleft:[{selector:"p,h1,h2,h3,h4,h5,h6,td,th,div,ul,ol,li",styles:{textAlign:"left"}},{selector:"img,table,dl.wp-caption",classes:"alignleft"}],aligncenter:[{selector:"p,h1,h2,h3,h4,h5,h6,td,th,div,ul,ol,li",styles:{textAlign:"center"}},{selector:"img,table,dl.wp-caption",classes:"aligncenter"}],alignright:[{selector:"p,h1,h2,h3,h4,h5,h6,td,th,div,ul,ol,li",styles:{textAlign:"right"}},{selector:"img,table,dl.wp-caption",classes:"alignright"}],strikethrough:{inline:"del"}},relative_urls:!1,remove_script_host:!1,convert_urls:!1,browser_spellcheck:!0,fix_list_elements:!0,entities:"38,amp,60,lt,62,gt",entity_encoding:"raw",keep_styles:!1,cache_suffix:"wp-mce-49110-20201110",resize:"vertical",menubar:!1,branding:!1,preview_styles:"font-family font-size font-weight font-style text-decoration text-transform",end_container_on_empty_block:!0,wpeditimage_html5_captions:!0,wp_lang_attr:"en-US",wp_keep_scroll_position:!1,wp_shortcut_labels:{"Heading 1":"access1","Heading 2":"access2","Heading 3":"access3","Heading 4":"access4","Heading 5":"access5","Heading 6":"access6",Paragraph:"access7",Blockquote:"accessQ",Underline:"metaU",Strikethrough:"accessD",Bold:"metaB",Italic:"metaI",Code:"accessX","Align center":"accessC","Align right":"accessR","Align left":"accessL",Justify:"accessJ",Cut:"metaX",Copy:"metaC",Paste:"metaV","Select all":"metaA",Undo:"metaZ",Redo:"metaY","Bullet list":"accessU","Numbered list":"accessO","Insert/edit image":"accessM","Insert/edit link":"metaK","Remove link":"accessS","Toolbar Toggle":"accessZ","Insert Read More tag":"accessT","Insert Page Break tag":"accessP","Distraction-free writing mode":"accessW","Add Media":"accessM","Keyboard Shortcuts":"accessH"},plugins:"charmap,colorpicker,hr,lists,media,paste,tabfocus,textcolor,fullscreen,wordpress,wpautoresize,wpeditimage,wpemoji,wpgallery,wplink,wpdialogs,wptextpattern,wpview",selector:"#vi-wpbulky-text-editor",wpautop:!0,indent:!1,toolbar1:"formatselect,bold,italic,bullist,numlist,blockquote,alignleft,aligncenter,alignright,link,wp_more,spellchecker,fullscreen,wp_adv",toolbar2:"strikethrough,hr,forecolor,pastetext,removeformat,charmap,outdent,indent,undo,redo,wp_help",tabfocus_elements:":prev,:next",body_class:"excerpt post-type-post post-status-publish page-template-default locale-en-us"},mediaButtons:!0,quicktags:!0},setColumns(i){try{let n=JSON.parse(i);a.columns=n.map((i=>(i&&i.editor&&e[i.editor]&&(i.editor=e[i.editor],i.editor.options=i.editor_options),i&&i.filter&&t[i.filter]&&(i.filter=t[i.filter]),i)))}catch(e){console.log(e)}}};window.Attributes=a;const n=wpbulkyI18n.i18n,o=jQuery,s={modal(e={}){let{header:t="",content:i="",actionsHtml:a=""}=e;return`<div class="vi-wpbulky-modal-container">\n                    <div class="vi-wpbulky-modal-main vi-ui form small">\n                        <i class="close icon"></i>\n                        <div class="vi-wpbulky-modal-wrapper">\n                            <h3 class="header">${t}</h3>\n                            <div class="content">${i}</div>\n                            <div class="actions">${a}</div>\n                        </div>\n                    </div>\n                </div>`},defaultAttributes(e={}){let{html:t}=e;return`<table class="vi-ui celled table">\n                    <thead>\n                    <tr>\n                        <th>Name</th>\n                        <th>Attribute</th>\n                    </tr>\n                    </thead>\n                    <tbody>\n                    ${t}\n                    </tbody>\n                </table>`}},l={setJexcel(e){this.jexcel=e},text:e=>n[e]||e,isUrl:e=>/^(http(s?):)\/\/.*\.(?:jpg|gif|png)$/i.test(e),formatText(e,t){let i="";if(t.length)for(let e=0;e<t.length;e++)t[e]&&(i+=t[e].text+"; ");e.innerText=i},createEditor(e,t,i="",a=!0){let n=document.createElement(t);"div"===t&&o(n).append(i),n.style.minWidth="300px";let s=o(n).innerHeight(),l=o(e).offset(),r=l.left,c=l.top,d=o(e).innerWidth(),p=e.getBoundingClientRect();a?(n.style.minHeight=p.height-2+"px",n.style.maxHeight=window.innerHeight-c-50+"px"):(n.style.opacity=0,n.style.fontSize=0),n.classList.add("vi-ui","segment","vi-wpbulky-cell-popup","vi-wpbulky-editing"),e.classList.add("editor"),e.appendChild(n);let u=o(n).innerWidth();if(o(this.jexcel.el).innerWidth()<r+u+d){let e=r-u>0?r-u:10;o(n).css("left",e+"px")}else o(n).css("left",r+d+"px");if(window.innerHeight<c+s){let e=c-s<0?0:c-s;o(n).css("top",e+"px")}else o(n).css("top",c+"px");return n},createModal(e={}){let{actions:t}=e,i="";if(Array.isArray(t))for(let e of t)i+=`<span class="${e.class} vi-ui button tiny">${e.text}</span>`;return o(s.modal({...e,actionsHtml:i}))},removeModal(e){o(e).find(".vi-wpbulky-modal-container").remove(),o(".select2-container--open").remove()},getColFromColumnType:e=>a.idMappingFlip[e]||"",getPostTypeFromCell(e){let t=e.getAttribute("data-y"),i=this.getColFromColumnType("post_type");return this.jexcel.options.data[t][i]},getPostTypeFromY(e){let t=this.getColFromColumnType("post_type");return this.jexcel.options.data[e][t]},getColumnType:e=>a.idMapping[e],stripHtml:e=>o(`<div>${e}</div>`).text(),getDataFromCell(e,t){let i=t.getAttribute("data-y"),a=t.getAttribute("data-x");return e.options.data[i][a]},getPostIdOfCell(e,t){if("object"==typeof t){let i=t.getAttribute("data-y");return e.options.data[i][0]}return e.options.data[t][0]},ajax(e={}){let t=Object.assign({url:wpbulkyParams.ajaxUrl,type:"post",dataType:"json"},e);t.data.action="vi_wpbulky_ajax",t.data.vi_wpbulky_nonce=wpbulkyParams.nonce,t.data.post_type=wpbulkyParams.postType,o.ajax(t)},pagination(e,t){let i="",a=`<a class="item ${1===(t=parseInt(t))?"disabled":""}" data-page="${t-1}"><i class="icon angle left"> </i></a>`,n=`<a class="item ${t===(e=parseInt(e))?"disabled":""}" data-page="${t+1}"><i class="icon angle right"> </i></a>`,o=`<input type="number" class="vi-wpbulky-go-to-page" value="${t}" min="1" max="${e}"/>`;for(let a=1;a<=e;a++)[1,t-1,t,t+1,e].includes(a)&&(i+=`<a class="item ${t===a?"active":""}" data-page="${a}">${a}</a>`),a===t-2&&t-2>1&&(i+='<a class="item disabled">...</a>'),a===t+2&&t+2<e&&(i+='<a class="item disabled">...</a>');return`<div class="vi-ui pagination menu">${a} ${i} ${n} </div> ${o}`},spinner:()=>o('<span class="vi-wpbulky-spinner"><span class="vi-wpbulky-spinner-inner"> </span></span>'),is_loading(){return!!this._spinner},loading(){this._spinner=this.spinner(),o(".vi-wpbulky-menu-bar-center").html(this._spinner)},removeLoading(){this._spinner=null,o(".vi-wpbulky-menu-bar-center").html("")},notice(e,t="black"){let i=o(`<div class="vi-wpbulky-notice" style="color:${t}">${e}</div>`);o(".vi-wpbulky-menu-bar-center").html(i),setTimeout((function(){i.remove()}),5e3)},showMessage({title:e="",message:t="",type:i="positive",duration:a=3e3}){const n=o("#vi-wpbulky-container").find("#vi-hui-toast");if(n.get(0)){const s=o("<div></div>"),l=setTimeout((function(){n.find(".vi-ui.message").remove()}),a+1e3);s.on("click",".icon.close",(function(e){n.find(".vi-ui.message").remove(),clearTimeout(l)})),n.children().length>0&&(n.find(".vi-hui-toast").first().remove(),clearTimeout(l));const r=(a/1e3).toFixed(2);"rtl"===o("html").attr("dir")?s.css({animation:`slideInRight ease .3s, fadeOut linear 1s ${r}s forwards`}):s.css({animation:`slideInLeft ease .3s, fadeOut linear 1s ${r}s forwards`}),s.addClass(`vi-ui ${i} message`),s.html(`<i class="close icon"></i>\n                          <div class="header">\n                            ${e}\n                          </div>\n                          <p>${t}</p>`),n.children().length>0?i!==n.find(".vi-ui.message").first().attr("class").split(/\s+/)[1]&&n.append(s):n.append(s)}}};let r=null;class c{constructor(e,t){return r||o("body").on("mousedown keydown",this.mousedown),r=this,this.render(e,o(t))}mousedown(e){let t=o(e.target),i=o(".vi-wpbulky-context-popup");(27===e.which||!t.hasClass("vi-wpbulky-context-popup")&&0===t.closest(".vi-wpbulky-context-popup").length&&i.hasClass("vi-wpbulky-popup-active"))&&i.empty().removeClass("vi-wpbulky-popup-active")}render(e,t){let i=o(".vi-wpbulky-context-popup"),a=i.innerWidth(),n=i.innerHeight(),s=t.offset(),l=s.left,r=s.top,c=t.innerWidth();if(window.innerWidth<l+a+c){let e=l-a>0?l-a:10;i.css("left",e+"px")}else i.css("left",l+c+"px");if(window.innerHeight<r+n){let e=r-n<0?0:r-n;i.css("top",e+"px")}else i.css("top",r+"px");i.empty(),i.addClass("vi-wpbulky-popup-active").html(e)}}const d=class{constructor(e,t,i,a){this._data={},this._data.jexcel=e,this._data.x=parseInt(t),this._data.y=parseInt(i),this.run()}get(e){return this._data[e]||""}run(){let e=this.content(),t=o(`td[data-x=${this.get("x")||0}][data-y=${this.get("y")||0}]`);new c(e,t),e.on("click",".vi-wpbulky-apply-formula",this.applyFormula.bind(this)),e.on("change",".vi-wpbulky-rounded",this.toggleDecimalValue)}content(){return o(`<div class="vi-wpbulky-formula-container" style="display: flex;">\n                    <select class="vi-wpbulky-operator">\n                        <option value="+">+</option>\n                        <option value="-">-</option>\n                    </select>\n                    <input type="number" min="0" class="vi-wpbulky-value">\n                    <select class="vi-wpbulky-unit">\n                        <option value="fixed">n</option>\n                        <option value="percentage">%</option>\n                    </select>\n                    <select class="vi-wpbulky-rounded">\n                        <option value="no_round">${l.text("No round")}</option>\n                        <option value="round">${l.text("Round with decimal")}</option>\n                        <option value="round_up">${l.text("Round up")}</option>\n                        <option value="round_down">${l.text("Round down")}</option>\n                    </select>\n                    <input type="number" min="0" max="10" class="vi-wpbulky-decimal" value="0">\n                    <button type="button" class="vi-ui button mini vi-wpbulky-apply-formula">${l.text("OK")}</button>\n                </div>`)}applyFormula(e){let t=o(e.target).closest(".vi-wpbulky-formula-container"),i=t.find(".vi-wpbulky-operator").val(),a=parseFloat(t.find(".vi-wpbulky-value").val()),n=t.find(".vi-wpbulky-unit").val(),s=t.find(".vi-wpbulky-rounded").val(),l=parseInt(t.find(".vi-wpbulky-decimal").val()),r=this.get("jexcel");if(!a)return;let c=[],d=r.selectedContainer,p=d[1],u=d[3],m=d[0];function h(e){e=parseFloat(e);let t="percentage"===n?e*a/100:a,o="-"===i?e-t:e+t;switch(s){case"round":o=o.toFixed(l);break;case"round_up":o=Math.ceil(o);break;case"round_down":o=Math.floor(o)}return o}for(let e=p;e<=u;e++)if(r.records[e][m]&&!r.records[e][m].classList.contains("readonly")&&"none"!==r.records[e][m].style.display){let t=r.options.data[e][m]||0;c.push(r.updateCell(m,e,h(t))),r.updateFormulaChain(m,e,c)}r.setHistory({action:"setValue",records:c,selection:r.selectedCell}),r.updateTable()}toggleDecimalValue(){let e=o(this).closest(".vi-wpbulky-formula-container");e.find(".vi-wpbulky-decimal").hide(),"round"===o(this).val()&&e.find(".vi-wpbulky-decimal").show()}};class p{constructor(){o(".vi-ui.menu .item").vi_tab(),this.revision={},this.sidebar=o("#vi-wpbulky-sidebar"),this.historyBodyTable=o("#vi-wpbulky-history-points-list tbody"),this.sidebar.on("click",".vi-wpbulky-apply-filter",this.applyFilter.bind(this)),this.sidebar.on("click",".vi-wpbulky-filter-label",this.filterInputLabelFocus),this.sidebar.on("focus",".vi-wpbulky-filter-input",this.filterInputFocus),this.sidebar.on("blur",".vi-wpbulky-filter-input",this.filterInputBlur),this.sidebar.on("click",".vi-wpbulky-get-meta-fields",this.getMetaFields.bind(this)),this.sidebar.on("click",".vi-wpbulky-save-meta-fields",this.saveMetaFields.bind(this)),this.sidebar.on("click",".vi-wpbulky-add-new-meta-field",this.addNewMetaField.bind(this)),this.sidebar.find("table.vi-wpbulky-meta-fields-container tbody").sortable({axis:"y"}),this.sidebar.find("table.vi-wpbulky-meta-fields-container").on("click",".vi-wpbulky-remove-meta-row",this.removeMetaRow),this.sidebar.on("click",".vi-wpbulky-save-settings",this.saveSettings.bind(this)),this.sidebar.on("click",".vi-wpbulky-view-history-point",this.viewHistoryPoint.bind(this)),this.sidebar.on("click",".vi-wpbulky-recover",this.recover.bind(this)),this.sidebar.on("click",".vi-wpbulky-revert-this-point",this.revertAllPosts.bind(this)),this.sidebar.on("click",".vi-wpbulky-revert-this-key",this.revertPostAttribute.bind(this)),this.sidebar.on("click",".vi-wpbulky-pagination a.item",this.changePage.bind(this)),this.sidebar.on("change",".vi-wpbulky-go-to-page",this.changePageByInput.bind(this)),this.sidebar.on("click",".vi-wpbulky-multi-select-clear",this.clearMultiSelect),this.filter(),this.settings(),this.metafields(),this.history()}filter(){let e=o("#vi-wpbulky-posts-filter"),t=o(".vi-wpbulky-filter-input"),i={top:-2},a={top:"50%"};t.each(((e,t)=>{o(t).val()&&o(t).parent().prev().css(i)})),t.on("focus",(function(){let e=o(this).prev();e.css(i),o(this).on("blur",(function(){o(this).val()||e.css(a)}))})),this.sidebar.on("click",".vi-wpbulky-filter-label",(function(){o(this).next().trigger("focus")}));let n=e.find(".vi-wpbulky.vi-ui.dropdown").dropdown({clearable:!0}),s=e.find(".vi-ui.compact.dropdown").dropdown();this.sidebar.on("click",".vi-wpbulky-clear-filter",(function(){o(".vi-wpbulky-filter-label").css(a),t.val(""),n.dropdown("clear"),s.find(".menu .item:first").trigger("click")}))}settings(){o(".vi-wpbulky-settings-tab").find("select.dropdown").dropdown()}metafields(){this.renderMetaFieldsTable(a.metaFields)}history(){this.pagination(1)}pagination(e,t=a.historyPages){this.sidebar.find(".vi-wpbulky-pagination").html(l.pagination(t,e))}applyFilter(e){let t=this,i=o(e.target);if(i.hasClass("loading"))return;let n="comment"===wpbulkyParams.postType?"add_filter_comment_data":"add_filter_data";l.ajax({data:{sub_action:n,filter_data:o("#vi-wpbulky-posts-filter").serialize(),filter_key:a.filterKey},beforeSend(){i.addClass("loading")},success(e){i.removeClass("loading"),t.sidebar.trigger("afterAddFilter",[e.data]),l.showMessage({title:"Success",message:"Filtered successfully",type:"positive",duration:3e3})}})}saveSettings(e){let t=this,i=o(e.target);if(i.hasClass("loading"))return;let n="comment"===wpbulkyParams.postType?"save_comment_settings":"save_settings";l.ajax({data:{sub_action:n,fields:o("form.vi-wpbulky-settings-tab").serialize()},beforeSend(){i.addClass("loading")},success(e){e.success&&(a.settings=e.data.settings,clearInterval(t.autoSaveRevision),t.sidebar.trigger("afterSaveSettings",[e.data])),i.removeClass("loading")}})}filterInputLabelFocus(){o(this).next().find("input").trigger("focus")}filterInputFocus(){o(this).parent().prev().css({top:-2})}filterInputBlur(){o(this).val()||o(this).parent().prev().css({top:"50%"})}getMetaFields(e){let t=this,i=o(e.target);i.hasClass("loading")||l.ajax({data:{sub_action:"get_meta_fields",current_meta_fields:t.getCurrentMetaFields()},beforeSend(){i.addClass("loading")},success(e){t.renderMetaFieldsTable(e.data),a.metaFields=e.data,i.removeClass("loading")}})}renderMetaFieldsTable(e){let t="";for(let i in e)t+=this.renderRow(i,e);o(".vi-wpbulky-meta-fields-container tbody").html(t)}renderRow(e,t){let i=t[e]||{},a="",n=i.input_type||"",o={textinput:"Text input",texteditor:"Text editor",numberinput:"Number input",array:"Array",json:"JSON",checkbox:"Checkbox",calendar:"Calendar",image:"Image (Save image's id)",imageurl:"Image (Save image's url)"};for(let e in o)a+=`<option value="${e}" ${e===n?"selected":""}>${o[e]}</option>`;let s=i.meta_value||"",l=s.slice(0,15),r=s.length>16?`<div class="vi-wpbulky-full-meta-value">${s}</div>`:"";return l+=l.length<s.length?"...":"",`<tr>\n                        <td class="vi-wpbulky-meta-key-col vi-wpbulky-meta-key">${e}</td>\n                        <td class="vi-wpbulky-column-name-col"><input type="text" class="vi-wpbulky-meta-column-name" value="${i.column_name||""}"></td>\n                        <td class="vi-wpbulky-value-format-col">\n                            <div class="vi-wpbulky-display-meta-value">\n                                <div class="vi-wpbulky-short-meta-value">${l}</div>\n                                ${r}\n                            </div>\n                        </td>\n                        <td class="vi-wpbulky-column-type-col">\n                            <select class="vi-wpbulky-meta-column-type">${a}</select>\n                        </td>\n                         <td class="vi-wpbulky-column-multiple-col">\n                            <input type="checkbox" class="vi-wpbulky-meta-column-multiple" ${parseInt(i.multiple)?"checked":""}>\n                        </td>\n                        <td class="vi-wpbulky-active-col vi-wpbulky-meta-field-active-column">\n                            <input type="checkbox" class="vi-wpbulky-meta-column-active" ${parseInt(i.active)?"checked":""}>\n                        </td>\n                        <td class="vi-wpbulky-actions-col">\n                            <div class="vi-wpbulky-meta-field-actions">\n                                <span class="vi-ui button basic mini vi-wpbulky-remove-meta-row"><i class="icon trash"> </i></span>\n                                <span class="vi-ui button basic mini"><i class="icon move"> </i></span>\n                            </div>\n                        </td>\n                    </tr>`}saveMetaFields(e){let t=o(e.target);t.hasClass("loading")||l.ajax({data:{sub_action:"save_meta_fields",meta_fields:this.getCurrentMetaFields()},beforeSend(){t.addClass("loading")},success(e){t.removeClass("loading"),location.reload()},error(e){console.log(e)}})}getCurrentMetaFields(){let e={},t=a.metaFields;return o("table.vi-wpbulky-meta-fields-container tbody tr").each((function(i,a){let n=o(a).find(".vi-wpbulky-meta-key").text();e[n]={column_name:o(a).find(".vi-wpbulky-meta-column-name").val(),input_type:o(a).find(".vi-wpbulky-meta-column-type").val(),active:o(a).find(".vi-wpbulky-meta-column-active:checked").length,meta_value:t[n]?t[n].meta_value:"",multiple:o(a).find(".vi-wpbulky-meta-column-multiple:checked").length}})),e}addNewMetaField(e){let t=o(e.currentTarget).prev(),i=t.val(),n=i.match(/^[\w\d_-]*$/g);if(!i||!n||a.metaFields[i])return;let s=this.renderRow(i,{});s&&(t.val(""),o("table.vi-wpbulky-meta-fields-container tbody").append(s))}removeMetaRow(){o(this).closest("tr").remove()}viewHistoryPoint(e){let t=o(e.currentTarget),i=t.data("id"),a=this;if(t.hasClass("loading"))return;let n="comment"===wpbulkyParams.postType?"view_comment_history_point":"view_history_point";l.ajax({data:{sub_action:n,id:i},beforeSend(){t.addClass("loading")},complete(){},success(e){if(t.removeClass("loading"),e.success&&e.data){let t=e.data.compare,n="";for(let e in t){let i=t[e];n+=`<div class="vi-wpbulky-history-post" data-post_id="${e}">\n                                        <div class="title">\n                                            <i class="dropdown icon"></i>\n                                            ${i.name}\n                                            <span class="vi-ui button mini basic vi-wpbulky-revert-this-post">\n                                                <i class="icon undo"> </i>\n                                            </span>\n                                            \n                                        </div>`;let a="";for(let t in i.fields){let n="string"==typeof i.current[t]?i.current[t]:JSON.stringify(i.current[t]),o="string"==typeof i.history[t]?i.history[t]:JSON.stringify(i.history[t]);a+=`<tr>\n                                            <td>${i.fields[t]}</td>\n                                            <td>${n}</td>\n                                            <td>${o}</td>\n                                            <td class="">\n                                                <span class="vi-ui button basic mini vi-wpbulky-revert-this-key" data-post_id="${e}" data-post_key="${t}">\n                                                    <i class="icon undo"> </i>\n                                                </span>\n                                            </td>\n                                        </tr>`}a=`<table id="vi-wpbulky-history-point-detail" class="vi-ui celled table">\n                                    <thead>\n                                    <tr>\n                                        <th>Attribute</th>\n                                        <th>Current value in database</th>\n                                        <th>History</th>\n                                        <th class="">Revert</th>\n                                    </tr>\n                                    </thead>\n                                    <tbody>\n                                    ${a}\n                                    </tbody>\n                                </table>`,n+=`<div class="content">${a}</div></div>`}n=o(`<div class="vi-ui styled fluid accordion">${n}</div>`),o(".vi-wpbulky-history-review").html(n).attr("data-history_id",i).prepend(`<h4>History point: ${e.data.date}</h4>`).append(`<div class="vi-ui button tiny vi-wpbulky-revert-this-point">\n                                    ${l.text("Revert all post in this point")}\n                                </div>\n                                <p> ${l.text("The current value is the value of the post in database")}</p>`),n.find(".title").on("click",(e=>a.revertSinglePost(e))),n.vi_accordion(),n.find(".title:first").trigger("click")}}})}recover(e){let t=o(e.currentTarget),i=t.data("id");if(t.hasClass("loading"))return;let a="comment"===wpbulkyParams.postType?"revert_history_all_comments":"revert_history_all_posts";l.ajax({data:{sub_action:a,history_id:i},beforeSend(){t.addClass("loading")},complete(){t.removeClass("loading")},success(e){console.log(e),l.showMessage({title:"Success",message:"Reverted successfully",type:"positive",duration:3e3})}})}revertSinglePost(e){let t;if(o(e.target).hasClass("vi-wpbulky-revert-this-post")&&(t=o(e.target)),o(e.target).parent().hasClass("vi-wpbulky-revert-this-post")&&(t=o(e.target).parent()),t){e.stopImmediatePropagation();let i=t.closest(".vi-wpbulky-history-post").data("post_id"),a=t.closest(".vi-wpbulky-history-review").attr("data-history_id");if(t.hasClass("loading"))return;let n="comment"===wpbulkyParams.postType?"revert_history_single_comment":"revert_history_single_post";l.ajax({data:{sub_action:n,history_id:a,pid:i},beforeSend(){t.addClass("loading")},complete(){t.removeClass("loading")},success(e){console.log(e),l.showMessage({title:"Success",message:"Reverted successfully",type:"positive",duration:3e3})}})}}revertAllPosts(e){let t=o(e.target),i=t.closest(".vi-wpbulky-history-review").data("history_id");if(t.hasClass("loading"))return;let a="comment"===wpbulkyParams.postType?"revert_history_all_comments":"revert_history_all_posts";l.ajax({data:{sub_action:a,history_id:i},beforeSend(){t.addClass("loading")},complete(){t.removeClass("loading")},success(e){console.log(e),l.showMessage({title:"Success",message:"Reverted successfully",type:"positive",duration:3e3})}})}revertPostAttribute(e){let t=o(e.currentTarget),i=t.data("post_key"),a=t.closest(".vi-wpbulky-history-post").data("post_id"),n=t.closest(".vi-wpbulky-history-review").data("history_id");if(t.hasClass("loading"))return;let s="comment"===wpbulkyParams.postType?"revert_history_comment_attribute":"revert_history_post_attribute";l.ajax({data:{sub_action:s,attribute:i,history_id:n,pid:a},beforeSend(){t.addClass("loading")},complete(){t.removeClass("loading")},success(e){console.log(e),l.showMessage({title:"Success",message:"Reverted Post Attribute successfully",type:"positive",duration:3e3})}})}changePage(e){let t=parseInt(o(e.currentTarget).attr("data-page"));o(e.currentTarget).hasClass("active")||o(e.currentTarget).hasClass("disabled")||!t||this.loadHistoryPage(t)}changePageByInput(e){let t=parseInt(o(e.target).val());t<=parseInt(o(e.target).attr("max"))&&t>0&&this.loadHistoryPage(t)}clearMultiSelect(){o(this).parent().find(".vi-ui.dropdown").dropdown("clear")}loadHistoryPage(e){let t=l.spinner(),i=this;e&&l.ajax({dataType:"text",data:{sub_action:"load_history_page",page:e},beforeSend(){i.sidebar.find(".vi-wpbulky-pagination").prepend(t)},complete(){t.remove()},success(t){i.pagination(e),o("#vi-wpbulky-history-points-list tbody").html(t)}})}saveRevision(){let e=parseInt(a.settings.auto_save_revision);if(0===e)return;let t=this;this.autoSaveRevision=setInterval((function(){if(Object.keys(t.revision).length){let e=t.sidebar.find(".vi-wpbulky-pagination a.item.active").data("page")||1,i="comment"===wpbulkyParams.postType?"auto_save_revision_comment":"auto_save_revision";l.ajax({data:{sub_action:i,data:t.revision,page:e||1},success(i){i.success&&(i.data.pages&&(a.historyPages=i.data.pages),i.data.updatePage&&t.historyBodyTable.html(i.data.updatePage),t.revision={},t.pagination(e))}})}}),1e3*e)}}class u{constructor(e,t,i,a){this._data={},this._data.jexcel=e,this._data.x=parseInt(t),this._data.y=parseInt(i),this.run()}get(e){return this._data[e]||""}run(){let e=this.content(),t=o(`td[data-x=${this.get("x")||0}][data-y=${this.get("y")||0}]`);new c(e,t),e.on("click",".vi-wpbulky-apply-formula",this.applyFormula.bind(this))}content(){return o(`<div class="vi-wpbulky-formula-container">\n                    <div class="field">\n                        <input type="text" placeholder="${l.text("Find")}" class="vi-wpbulky-find-string">\n                    </div>\n                    <div class="field">\n                        <input type="text" placeholder="${l.text("Replace")}" class="vi-wpbulky-replace-string">\n                    </div>\n                    <button type="button" class="vi-ui button mini vi-wpbulky-apply-formula">${l.text("Replace")}</button>\n                </div>`)}applyFormula(e){let t=o(e.target).closest(".vi-wpbulky-formula-container"),i=t.find(".vi-wpbulky-find-string").val(),a=t.find(".vi-wpbulky-replace-string").val(),n=this.get("jexcel");if(!i)return;let s=[],l=n.selectedContainer,r=l[1],c=l[3],d=l[0];for(let e=r;e<=c;e++)if(n.records[e][d]&&!n.records[e][d].classList.contains("readonly")&&"none"!==n.records[e][d].style.display){let t=n.options.data[e][d].replaceAll(i,a);s.push(n.updateCell(d,e,t)),n.updateFormulaChain(d,e,s)}n.setHistory({action:"setValue",records:s,selection:n.selectedCell}),n.updateTable()}}class m{constructor(e,t,i,a){this._data={},this._data.jexcel=e,this._data.x=parseInt(t),this._data.y=parseInt(i),this.run()}get(e){return this._data[e]||""}run(){let e=this.content(),t=o(`td[data-x=${this.get("x")||0}][data-y=${this.get("y")||0}]`);new c(e,t),e.on("click",".vi-wpbulky-apply-formula",this.applyFormula.bind(this))}content(){return o(`<div class="vi-wpbulky-formula-container">\n                    <div class="field">\n                        <input type="text" placeholder="${l.text("Content")}" class="vi-wpbulky-text-input">\n                    </div>\n                    <button type="button" class="vi-ui button mini vi-wpbulky-apply-formula">${l.text("Save")}</button>\n                </div>`)}applyFormula(e){let t=o(e.target).closest(".vi-wpbulky-formula-container").find(".vi-wpbulky-text-input").val(),i=this.get("jexcel"),a=[],n=i.selectedContainer,s=n[1],l=n[3],r=n[0];for(let e=s;e<=l;e++)i.records[e][r]&&!i.records[e][r].classList.contains("readonly")&&"none"!==i.records[e][r].style.display&&(a.push(i.updateCell(r,e,t)),i.updateFormulaChain(r,e,a));i.setHistory({action:"setValue",records:a,selection:i.selectedCell}),i.updateTable()}}var h=i(744);jQuery(document).ready((function(e){new class{constructor(){this.sidebar=new p,this.compare=[],this.trash=[],this.unTrash=[],this.revision={},this.editor=e("#vi-wpbulky-container"),this.menubar=e("#vi-wpbulky-menu-bar"),this.menubar.on("click",".vi-wpbulky-open-sidebar",this.openMenu.bind(this)),this.menubar.on("click","a.item:not(.vi-wpbulky-open-sidebar)",this.closeMenu.bind(this)),this.menubar.on("click",".vi-wpbulky-new-post",this.addNewPost.bind(this)),this.menubar.on("click",".vi-wpbulky-full-screen-btn",this.toggleFullScreen.bind(this)),this.menubar.on("click",".vi-wpbulky-save-button",this.save.bind(this)),this.menubar.on("click",".vi-wpbulky-pagination a.item",this.changePage.bind(this)),this.menubar.on("click",".vi-wpbulky-get-post",this.reloadCurrentPage.bind(this)),this.menubar.on("change",".vi-wpbulky-go-to-page",this.changePageByInput.bind(this)),this.editor.on("cellonchange","tr",this.cellOnChange.bind(this)),this.editor.on("click",".jexcel_content",this.removeExistingEditor.bind(this)),this.editor.on("dblclick",this.removeContextPopup),this.sidebar.sidebar.on("afterAddFilter",this.afterAddFilter.bind(this)),this.sidebar.sidebar.on("afterSaveSettings",this.afterSaveSettings.bind(this)),this.sidebar.sidebar.on("click",".vi-wpbulky-close-sidebar",this.closeMenu.bind(this)),this.init(),e(document).on("keydown",this.keyDownControl.bind(this))}removeExistingEditor(e){e.target===e.currentTarget&&this.WorkBook&&this.WorkBook.edition&&this.WorkBook.closeEditor(this.WorkBook.edition[0],!0)}keyDownControl(e){!e.ctrlKey&&!e.metaKey||e.shiftKey||83===e.which&&(e.preventDefault(),this.save()),27===e.which&&this.sidebar.sidebar.removeClass("vi-wpbulky-open")}removeContextPopup(){e(".vi-wpbulky-context-popup").removeClass("vi-wpbulky-popup-active")}init(){wpbulkyParams.columns&&a.setColumns(wpbulkyParams.columns),this.pagination(1,1),this.workBookInit(),"comment"===wpbulkyParams.postType?this.loadComments():this.loadPosts(),l.setJexcel(this.WorkBook)}cellOnChange(t,i){let{col:n=""}=i;if(!n)return;let o=a.idMapping[n],s=e(t.target);if("post_date"===o){let e=i.value,t=l.getColFromColumnType("post_status"),a=s.find(`td[data-x='${t}']`).get(0),n=new Date(e).getTime()>Date.now()?"future":"publish";this.WorkBook.setValue(a,n)}}workBookInit(){let t,i=this;function n(e,t){let i=[],a=e.selectedContainer,n=a[1],o=a[3],s=a[0];for(let a=n;a<=o;a++)e.records[a][s]&&!e.records[a][s].classList.contains("readonly")&&"none"!==e.records[a][s].style.display&&(i.push(e.updateCell(s,a,t)),e.updateFormulaChain(s,a,i));e.setHistory({action:"setValue",records:i,selection:e.selectedCell}),e.updateTable()}t="comment"===wpbulkyParams.postType?function(t,o,s,r,c){let d=o.selectedContainer;if(s=parseInt(s),r=parseInt(r),null!==s&&null!==r){if(d[0]===d[2])switch(o.options.columns[s].type){case"text":t.push({title:l.text("Edit multiple cells"),onclick(e){new m(o,s,r,e)}}),t.push({title:l.text("Find and Replace"),onclick(e){new u(o,s,r,e)}});break;case"number":t.push({title:l.text("Find and Replace"),onclick(e){new u(o,s,r,e)}});break;case"calendar":let i=e(`td[data-x=${s}][data-y=${r}]`).get(0);e(i).hasClass("readonly")||t.push({title:l.text("Open date picker"),onclick(){let e=o.options.data[r][s];var t=l.createEditor(i,"input","",!1);t.value=e,t.style.left="unset";let a=o.selectedContainer,n=a[1],c=a[3];1!=o.options.tableOverflow&&1!=o.options.fullscreen||(o.options.columns[s].options.position=!0),o.options.columns[s].options.value=o.options.data[r][s],o.options.columns[s].options.opened=!0,o.options.columns[s].options.onclose=function(e,t){let i=[];t=e.value;for(let e=n;e<=c;e++)o.records[e][s]&&!o.records[e][s].classList.contains("readonly")&&"none"!==o.records[e][s].style.display&&(i.push(o.updateCell(s,e,t)),o.updateFormulaChain(s,e,i));o.setHistory({action:"setValue",records:i,selection:o.selectedCell}),o.updateTable()},jSuites.calendar(t,o.options.columns[s].options),t.focus()}})}"custom"===o.options.columns[s].type&&"function"==typeof o.options.columns[s].editor.tinymceInit&&t.push({title:l.text("Edit multiple cells"),onclick(){e(".vi-ui.modal").modal("show"),null===tinymce.get("vi-wpbulky-text-editor")?wp.editor.initialize("vi-wpbulky-text-editor",a.tinyMceOptions):tinymce.get("vi-wpbulky-text-editor").setContent(""),e(".vi-wpbulky-text-editor-save").off("click").on("click",(function(){let t=wp.editor.getContent("vi-wpbulky-text-editor");n(o,t),e(this).hasClass("vi-wpbulky-close")&&e(".vi-ui.modal").modal("hide")}))}});let c=null;if("object"==typeof r){let e=e.getAttribute("data-y");c=o.options.data[e][1]}else c=o.options.data[r][1];t.push({type:"line"}),t.push({title:l.text("Reply"),onclick(){e(".vi-ui.modal").modal("show"),null===tinymce.get("vi-wpbulky-text-editor")?wp.editor.initialize("vi-wpbulky-text-editor",a.tinyMceOptions):tinymce.get("vi-wpbulky-text-editor").setContent(""),e(".vi-wpbulky-text-editor-save").off("click").on("click",(function(){let t=wp.editor.getContent("vi-wpbulky-text-editor"),a=o.selectedContainer,n=a[1],s=a[3],r=(a[0],[]);for(let e=n;e<=s;e++)r.push({comment_id:l.getDataFromCell(o,o.records[e][0]),post_id:l.getDataFromCell(o,o.records[e][1])});i.addNewReply(t,r),e(this).hasClass("vi-wpbulky-close")&&e(".vi-ui.modal").modal("hide")}))}}),d[1]===d[3]&&t.push({title:l.text("View post"),onclick(){window.open(`${a.frontendUrl}?p=${c}&preview=true`,"_blank")}})}return t}:function(t,i,o,s,r){let c=i.selectedContainer;if(o=parseInt(o),s=parseInt(s),c[0]===c[2]&&o&&("checkbox"===i.options.columns[o].type&&(t.push({title:l.text("Check"),onclick(e){n(i,!0)}}),t.push({title:l.text("Uncheck"),onclick(e){n(i,!1)}})),"numeric"===i.options.columns[o].type&&t.push({title:l.text("Calculator"),onclick(e){new d(i,o,s,e)}}),"text"===i.options.columns[o].type&&(t.push({title:l.text("Edit multiple cells"),onclick(e){new m(i,o,s,e)}}),t.push({title:l.text("Find and Replace"),onclick(e){new u(i,o,s,e)}})),"custom"===i.options.columns[o].type&&"function"==typeof i.options.columns[o].editor.tinymceInit&&t.push({title:l.text("Edit multiple cells"),onclick(){e(".vi-ui.modal").modal("show"),null===tinymce.get("vi-wpbulky-text-editor")?wp.editor.initialize("vi-wpbulky-text-editor",a.tinyMceOptions):tinymce.get("vi-wpbulky-text-editor").setContent(""),e(".vi-wpbulky-text-editor-save").off("click").on("click",(function(){let t=wp.editor.getContent("vi-wpbulky-text-editor");n(i,t),e(this).hasClass("vi-wpbulky-close")&&e(".vi-ui.modal").modal("hide")}))}})),t.length&&t.push({type:"line"}),null!==o&&null!==s&&c[0]===c[2]&&c[1]===c[3]){let e=l.getPostIdOfCell(i,s);t.push({title:l.text("Duplicate"),onclick(){l.ajax({data:{sub_action:"duplicate_post",post_id:e},beforeSend(){l.loading()},success(e){e.data.length&&e.data.forEach((function(e,t){i.insertRow(0,s+t,!0,!0),i.setRowData(s+t,e,!0)})),l.removeLoading()}})}}),t.push({title:l.text("Go to edit page"),onclick(){window.open(`${a.adminUrl}post.php?post=${e}&action=edit`,"_blank")}}),t.push({title:l.text("Preview"),onclick(){window.open(`${a.frontendUrl}?p=${e}&preview=true`,"_blank")}}),t.length&&t.push({type:"line"})}return t},this.WorkBook=e("#vi-wpbulky-spreadsheet").jexcel({allowInsertRow:!1,allowInsertColumn:!1,about:!1,freezeColumns:3,tableOverflow:!0,tableWidth:"100%",tableHeight:"100%",columns:a.columns,stripHTML:!1,allowExport:!1,allowDeleteColumn:!1,allowRenameColumn:!1,autoIncrement:!1,allowXCopy:!1,text:{deleteSelectedRows:`${l.text("Delete selected rows")}`},contextMenuItems:t,onresizecolumn:function(e,t,i){l.ajax({async:!0,data:{sub_action:"resize_column",column_id:a.columns[t].id,column_width:i<=55?55:i},beforeSend(){},success(e){e.success&&console.log(e.data)},error(e){console.log(e.data),alert(e.data)},complete(){}})},onchange(t,a,n,o,s,r){if(JSON.stringify(s)!==JSON.stringify(r)){e(a).parent().trigger("cellonchange",{cell:a,col:n,row:o,value:s});let t=this.options.data[o][0];i.compare.push(t),i.compare=[...new Set(i.compare)],i.menubar.find(".vi-wpbulky-save-button").addClass("vi-wpbulky-saveable"),i.revision[t]||(i.revision[t]={});let c=l.getColumnType(n);i.revision[t][c]=r}},onbeforechange:(e,t,i,a,n)=>("object"!=typeof n&&(n=h.sanitize(n)),n),ondeleterow(e,t,a,n){for(let e of n)i.trash.push(e[0].innerText);i.trash.length&&i.menubar.find(".vi-wpbulky-save-button").addClass("vi-wpbulky-saveable")},onundo(e,t){if(t&&"deleteRow"===t.action)for(let e of t.rowData)i.unTrash.push(e[0])},onselection(t,i,n,o,s,l){if(i===o&&n===s){let t=this.getCellFromCoords(i,n),o=e(t).children();if(o.length&&o.hasClass("vi-wpbulky-gallery-has-item")){let o=this.options.data[n][i],s="";if(o.length)for(let e of o)s+=`<li class="vi-wpbulky-gallery-image"><img src="${a.imgStorage[e]}"></li>`;new c(`<ul class="vi-wpbulky-gallery-images">${s}</ul>`,e(t))}}},onbeforecopy(){i.firstCellCopy=null},oncopying(e,t,a){i.firstCellCopy||(i.firstCellCopy=[t,a])},onbeforepaste:(e,t)=>(i.firstCellCopy&&parseInt(i.firstCellCopy[0])!==parseInt(t[0])&&(e=""),e),onscroll(t){let i=e(t).find("select.select2-hidden-accessible");i.length&&i.select2("close")}})}closeMenu(e){this.sidebar.sidebar.removeClass("vi-wpbulky-open")}openMenu(t){let i=e(t.currentTarget).data("menu_tab"),a=this.sidebar.sidebar.find(`a.item[data-tab='${i}']`);a.hasClass("active")&&this.sidebar.sidebar.hasClass("vi-wpbulky-open")?this.sidebar.sidebar.removeClass("vi-wpbulky-open"):(this.sidebar.sidebar.addClass("vi-wpbulky-open"),a.trigger("click"))}addNewPost(){if(l.is_loading())return;let e=prompt(l.text("Please enter new post name"));if(e){let t=this;l.ajax({data:{sub_action:"add_new_post",post_name:e},beforeSend(){l.loading()},success(e){t.WorkBook.insertRow(0,0,!0,!0),t.WorkBook.setRowData(0,e.data,!0),l.removeLoading()}})}}addNewReply(e,t){if(l.is_loading())return;let i=this;l.ajax({data:{sub_action:"add_new_reply",content:e,new_comments:t},beforeSend(){l.loading()},success(e){console.log(e.data),i.isAdding=!1,l.removeLoading(),i.reloadCurrentPage()},error(e){console.log(e),alert(e.statusText+e.responseText)},complete(){i.isAdding=!1,l.removeLoading()}})}toggleFullScreen(t){let i=e(".wp-admin"),n=e(t.currentTarget);i.toggleClass("vi-wpbulky-full-screen"),i.hasClass("vi-wpbulky-full-screen")?(n.find("i.icon").removeClass("external alternate").addClass("window close outline"),n.attr("title","Exit full screen")):(n.find("i.icon").removeClass("window close outline").addClass("external alternate"),n.attr("title","Full screen")),e.ajax({url:a.ajaxUrl,type:"post",dataType:"json",data:{...a.ajaxData,sub_action:"set_full_screen_option",status:i.hasClass("vi-wpbulky-full-screen")}})}getAllRows(){return this.WorkBook.getData(!1,!0)}save(){let e=this,t=this.getAllRows(),i=[];for(let e of this.compare)for(let a of t)parseInt(a[0])===parseInt(e)&&i.push(a);l.is_loading()||function t(a=0){let n=20*a,o=n+20,s=i.slice(n,o),r=20*a>=i.length;if(0===s.length&&0===e.trash.length&&0===e.unTrash.length&&0===a)return void l.notice(l.text("Nothing change to save"));if(r&&a>0){let t=e.WorkBook.history;if(t.length)for(let e of t){if("deleteRow"!==e.action)continue;let t=[];for(let i in e.rowData)e.rowData[i][1]>0&&t.push(parseInt(i));t.length&&(e.rowData=e.rowData.filter(((e,i)=>!t.includes(i))),e.rowNode=e.rowNode.filter(((e,i)=>!t.includes(i))),e.rowRecords=e.rowRecords.filter(((e,i)=>!t.includes(i))),e.numOfRows=e.numOfRows-t.length)}return e.saveRevision(),void l.showMessage({title:"Success",message:"Saved successfully",type:"positive",duration:3e3})}let c="comment"===wpbulkyParams.postType?"save_comments":"save_posts";l.ajax({data:{sub_action:c,posts:JSON.stringify(s),trash:e.trash,untrash:e.unTrash},beforeSend(){l.loading()},success(i){e.trash=[],e.unTrash=[],e.compare=[],e.menubar.find(".vi-wpbulky-save-button").removeClass("vi-wpbulky-saveable"),l.removeLoading(),t(a+1)},error(e){l.showMessage({title:"Error",message:e.statusText+e.responseText,type:"negative",duration:3e3}),console.log(e)}})}()}loadPosts(e=1,t=!1){let i=this;l.is_loading()||l.ajax({data:{sub_action:"load_posts",page:e,re_create:t},beforeSend(){l.loading()},success(n){n.success&&(a.imgStorage=n.data.img_storage,t&&(i.WorkBook.destroy(),a.setColumns(n.data.columns),a.idMapping=n.data.idMapping,a.idMappingFlip=n.data.idMappingFlip,i.workBookInit()),i.WorkBook.options.data=n.data.posts,i.WorkBook.setData(),i.pagination(n.data.max_num_pages,e),i.WorkBook.orderAfterLoad(),l.removeLoading(),n.data.posts.length||l.notice(l.text("No post was found")))}})}loadComments(e=1,t=!1){let i=this;l.is_loading()||l.ajax({data:{sub_action:"load_comments",page:e,re_create:t},beforeSend(){l.loading()},success(n){n.success&&(t&&(i.WorkBook.destroy(),a.setColumns(n.data.columns),a.idMapping=n.data.idMapping,a.idMappingFlip=n.data.idMappingFlip,i.workBookInit()),i.WorkBook.options.data=n.data.posts,i.WorkBook.setData(),i.pagination(n.data.max_num_pages,e),l.removeLoading(),n.data.posts.length||l.notice(l.text("No post was found")))}})}pagination(e,t){this.menubar.find(".vi-wpbulky-pagination").html(l.pagination(e,t))}changePage(t){let i=parseInt(e(t.currentTarget).attr("data-page"));e(t.currentTarget).hasClass("active")||e(t.currentTarget).hasClass("disabled")||!i||this.loadPosts(i)}changePageByInput(t){let i=parseInt(e(t.target).val());i<=parseInt(e(t.target).attr("max"))&&i>0&&this.loadPosts(i)}reloadCurrentPage(){"comment"===wpbulkyParams.postType?this.loadComments(this.getCurrentPage()):this.loadPosts(this.getCurrentPage())}getCurrentPage(){return this.menubar.find(".vi-wpbulky-pagination .item.active").data("page")||1}afterAddFilter(e,t){a.imgStorage=t.img_storage,this.WorkBook.options.data=t.posts,this.WorkBook.setData(),this.pagination(t.max_num_pages,1),this.WorkBook.orderAfterLoad(),t.posts.length||l.notice(l.text("No post was found"))}afterSaveSettings(e,t){t.fieldsChange&&("comment"===wpbulkyParams.postType?this.loadComments(this.getCurrentPage(),!0):this.loadPosts(this.getCurrentPage(),!0))}saveRevision(){let t=this;if(Object.keys(t.revision).length){let i=t.sidebar.sidebar.find(".vi-wpbulky-pagination a.item.active").data("page")||1,a="comment"===wpbulkyParams.postType?"auto_save_revision_comment":"auto_save_revision";l.ajax({data:{sub_action:a,data:t.revision,page:i||1},success(a){a.success&&(a.data.updatePage&&e("#vi-wpbulky-history-points-list tbody").html(a.data.updatePage),t.revision={},t.sidebar.sidebar.find(".vi-wpbulky-pagination").html(l.pagination(a.data.pages,i)))}})}}}}))})()})();